"use strict";(self.webpackChunkcommunity_docs=self.webpackChunkcommunity_docs||[]).push([[5598],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>h});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),d=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},p=function(e){var t=d(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),c=d(a),h=r,m=c["".concat(s,".").concat(h)]||c[h]||u[h]||o;return a?n.createElement(m,l(l({ref:t},p),{},{components:a})):n.createElement(m,l({ref:t},p))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,l=new Array(o);l[0]=c;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var d=2;d<o;d++)l[d]=a[d];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},2305:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>m,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var n=a(7462),r=(a(7294),a(3905));const o={},l="Update Validator Withdrawals",i={unversionedId:"community-guides/validator-key-generation/withdrawal-update",id:"community-guides/validator-key-generation/withdrawal-update",title:"Update Validator Withdrawals",description:"The following guide will teach you how to update your plain BLS Validator Key to reference an ETH1 Address to allow your validator keys to withdraw staked LYX/LYXt and earnings. If an ETH1 Address is referenced to the BLS Key, the validator's stake can be exited to any wallet. The earnings of your validators will be automatically withdrawn regularly.",source:"@site/docs/community-guides/validator-key-generation/withdrawal-update.md",sourceDirName:"community-guides/validator-key-generation",slug:"/community-guides/validator-key-generation/withdrawal-update",permalink:"/docs/community-guides/validator-key-generation/withdrawal-update",draft:!1,editUrl:"https://github.com/Luksoverse/community-docs/tree/main/packages/create-docusaurus/templates/shared/docs/community-guides/validator-key-generation/withdrawal-update.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"CLI Validator Key Generation",permalink:"/docs/community-guides/validator-key-generation/lukso-deposit-cli"},next:{title:"Validator Staking Guide",permalink:"/docs/community-guides/validator-key-stake/"}},s={},d=[{value:"How to check withdrawals?",id:"how-to-check-withdrawals",level:2},{value:"Prepare Validator Indices",id:"prepare-validator-indices",level:2},{value:"Start the LUKSO KeyGen CLI",id:"start-the-lukso-keygen-cli",level:2},{value:"Generate the Withdrawal Credential",id:"generate-the-withdrawal-credential",level:2},{value:"Broadcast the Withdrawal Credential",id:"broadcast-the-withdrawal-credential",level:2}],p=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",t)},u=p("Tabs"),c=p("TabItem"),h={toc:d};function m(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},h,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"update-validator-withdrawals"},"Update Validator Withdrawals"),(0,r.kt)("p",null,"The following guide will teach you how to update your plain ",(0,r.kt)("strong",{parentName:"p"},"BLS Validator Key")," to reference an ",(0,r.kt)("strong",{parentName:"p"},"ETH1 Address")," to allow your validator keys to withdraw staked LYX/LYXt and earnings. If an ETH1 Address is referenced to the BLS Key, the validator's stake can be exited to any wallet. The earnings of your validators will be automatically withdrawn regularly."),(0,r.kt)("admonition",{title:"Key Generation",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"The ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/lukso-network/tools-wagyu-key-gen#lukso-wagyu-keygen"},"LUKSO KeyGen GUI")," automatically adds a withdrawal address during setup.")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"BLS Keys")," are the backbone of the digital signature type to secure the ",(0,r.kt)("strong",{parentName:"li"},"PoS Consensus Layer")," of EVM blockchains. Every validator uses them to sign blocks and stake LYX/LYXt on the LUKSO networks."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"ETH1 Addresses")," are the traditional Ethereum addresses from ",(0,r.kt)("em",{parentName:"li"},"Externally Owned Accounts")," or ",(0,r.kt)("em",{parentName:"li"},"Smart Contracts")," on the ",(0,r.kt)("strong",{parentName:"li"},"Execution Layer")," which can receive tokens or coins on the network.")),(0,r.kt)("h2",{id:"how-to-check-withdrawals"},"How to check withdrawals?"),(0,r.kt)("p",null,"If you've never updated your validator withdrawals after the initial deposit, you can check the ",(0,r.kt)("inlineCode",{parentName:"p"},"deposit_data.json")," file of the validator locally. To check if your withdrawals are executed on the network, you can check them using the consensus explorer."),(0,r.kt)("admonition",{title:"Withdrawal Activation Time",type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"If you've updated your ETH1 recently, its activation can take up to 48 hours.")),(0,r.kt)(u,{mdxType:"Tabs"},(0,r.kt)(c,{value:"local-deposit-check",label:"Local Deposit File Check",mdxType:"TabItem"},(0,r.kt)("div",null,(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Open the ",(0,r.kt)("inlineCode",{parentName:"li"},"deposit_data.json")," file of the validator"),(0,r.kt)("li",{parentName:"ol"},"Search for the ",(0,r.kt)("inlineCode",{parentName:"li"},"withdrawal_credentials")," properties for every key",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"If the hexadecimal number starts with ",(0,r.kt)("inlineCode",{parentName:"li"},"01"),", withdrawals are already enabled"),(0,r.kt)("li",{parentName:"ul"},"If the hexadecimal number starts with ",(0,r.kt)("inlineCode",{parentName:"li"},"00"),", withdrawals are disabled")))),(0,r.kt)("p",null,"If your withdrawals are disabled, follow this guide to set a withdrawal address."))),(0,r.kt)(c,{value:"consensus-explorer-check",label:"Consensus Explorer Check",mdxType:"TabItem"},(0,r.kt)("div",null,(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Open the deposit file of your validator and copy the ",(0,r.kt)("inlineCode",{parentName:"li"},"pubkey")," element of the specific validator key"),(0,r.kt)("li",{parentName:"ol"},"Search for your validator by entering its public key into the search bar of the related consensus explorer:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://explorer.consensus.mainnet.lukso.network/"},"LUKSO Mainnet Consensus Explorer")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://explorer.consensus.mainnet.lukso.network/"},"LUKSO Testnet Consensus Explorer")))),(0,r.kt)("li",{parentName:"ol"},"View the validator\u2019s details and open the ",(0,r.kt)("strong",{parentName:"li"},"Withdrawals")," section",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"If you see withdrawals, the withdrawal credentials are working correctly"),(0,r.kt)("li",{parentName:"ul"},"If there are no withdrawals, they are still disabled")))),(0,r.kt)("p",null,"If you don't see any withdrawals, follow this guide to set a withdrawal address.")))),(0,r.kt)("h2",{id:"prepare-validator-indices"},"Prepare Validator Indices"),(0,r.kt)("p",null,"To update your withdrawals, you have to specify the on-chain indices for each of the deposited validator keys. You can get them directly from the node machine or manually check your public keys on the consensus explorer."),(0,r.kt)(u,{mdxType:"Tabs"},(0,r.kt)(c,{value:"index-from-explorer",label:"Get Indices Numbers from Explorer",mdxType:"TabItem"},(0,r.kt)("div",null,(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Open the deposit file of your validator and copy the ",(0,r.kt)("inlineCode",{parentName:"li"},"pubkey")," element of a validator key."),(0,r.kt)("li",{parentName:"ol"},"Search for your validator by entering its public key into the search bar of the related consensus explorer:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://explorer.consensus.mainnet.lukso.network/"},"LUKSO Mainnet Consensus Explorer")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://explorer.consensus.mainnet.lukso.network/"},"LUKSO Testnet Consensus Explorer")))),(0,r.kt)("li",{parentName:"ol"},"Copy the validator index property")),(0,r.kt)("p",null,"The steps need to be repeated for every validator key."))),(0,r.kt)(c,{value:"index-from-node",label:"Get Indices Numbers from Node",mdxType:"TabItem"},(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"The following properties need to be exchanged:"),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"<node-working-directory>")," with the actual folder name"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"<network-type>")," with ",(0,r.kt)("inlineCode",{parentName:"li"},"mainnet"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"devnet"),", or ",(0,r.kt)("inlineCode",{parentName:"li"},"testnet")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"<latest-validator-logs.log>")," with the latest validator log file"))),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Log into your node\u2019s terminal"),(0,r.kt)("li",{parentName:"ol"},"Move into the logging folder of the node\u2019s working directory.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cd <node-working-directory>/<network-type>-logs/\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Search and print out all validator indices of the active validator")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cat <latest-validator-logs.log> | grep -o 'index=[0-9]* ' | awk -F'=' '{printf \"%s,\", $2}' | sed 's/,$//' | tr -d ' '\n")))),"Copy the validator indices so they can be used to generate the withdrawal credential later on.",(0,r.kt)("h2",{id:"start-the-lukso-keygen-cli"},"Start the LUKSO KeyGen CLI"),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"The LUKSO KeyGen CLI should only be used on a secure offline device."),(0,r.kt)("p",{parentName:"admonition"},"You will need to input your ",(0,r.kt)("strong",{parentName:"p"},"Validator Seed Phrase")," again.")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Download the latest version of the ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/lukso-network/tools-key-gen-cli/releases"},"LUKSO KeyGen CLI")),(0,r.kt)("li",{parentName:"ol"},"Transfer the archive to a secure device."),(0,r.kt)("li",{parentName:"ol"},"Extract the archive to receive the executable binary file"),(0,r.kt)("li",{parentName:"ol"},"Open the terminal and move into the generated folder")),(0,r.kt)("h2",{id:"generate-the-withdrawal-credential"},"Generate the Withdrawal Credential"),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"If you want to have different withdrawal credentials, the following steps must be repeated multiple times.")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"You will need the following information:"),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"Validator Indices (Previous Step)"),(0,r.kt)("li",{parentName:"ul"},"Old Withdrawal Credentials for each Key (Deposit File)"),(0,r.kt)("li",{parentName:"ul"},"New ETH1 Withdrawal Address (Generated)"))),(0,r.kt)("p",null,"Start the BLS to Execution process from the LUKSO KeyGen CLI"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"./lukso-key-gen generate-bls-to-execution-change\n")),(0,r.kt)("admonition",{title:"Index Position",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"During the setup, you will have to define an index position of the validator keys, indicating the starting point of your credential generation."),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"To generate the withdrawal credentials from the first key, set the index position to ",(0,r.kt)("inlineCode",{parentName:"li"},"0"),"."),(0,r.kt)("li",{parentName:"ul"},"To generate the withdrawal credentials for the 11th key onwards, set the index position to ",(0,r.kt)("inlineCode",{parentName:"li"},"10"),"."))),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Select your language"),(0,r.kt)("li",{parentName:"ol"},"Select the network which your validators are running on"),(0,r.kt)("li",{parentName:"ol"},"Enter your ",(0,r.kt)("strong",{parentName:"li"},"Validator Seed Phrase")," that you\u2019ve used to generate your initial BSL keys"),(0,r.kt)("li",{parentName:"ol"},"Enter the index position of the keys you want to create withdrawal credentials for"),(0,r.kt)("li",{parentName:"ol"},"Enter all your validator indices to enable withdrawals for, separated with whitespaces or commas"),(0,r.kt)("li",{parentName:"ol"},"Enter a list of the old BLS withdrawal credentials of your validator keys, separated with whitespaces or commas"),(0,r.kt)("li",{parentName:"ol"},"Enter the ETH1 address that all earnings will be withdrawn to")),(0,r.kt)("p",null,"The ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/lukso-network/tools-key-gen-cli/releases"},"LUKSO KeyGen CLI")," will then generate a ",(0,r.kt)("inlineCode",{parentName:"p"},"bls_to_execution_change.json")," file."),(0,r.kt)("p",null,"You can proceed to the next step once the withdrawal credential is generated successfully."),(0,r.kt)("h2",{id:"broadcast-the-withdrawal-credential"},"Broadcast the Withdrawal Credential"),(0,r.kt)("admonition",{type:"warning"},(0,r.kt)("p",{parentName:"admonition"},"The withdrawal credential can only be set once. Ensure to have ownership over the withdrawal address.")),(0,r.kt)("p",null,"The ",(0,r.kt)("strong",{parentName:"p"},"Withdrawal Credential")," can be shared directly from your node or the public consensus explorer of the related network."),(0,r.kt)(u,{mdxType:"Tabs"},(0,r.kt)(c,{value:"broadcast-from-explorer",label:"Broadcast Message from Explorer",mdxType:"TabItem"},(0,r.kt)("div",null,(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Open the broadcast window of the consensus explorer of the related network:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://explorer.consensus.mainnet.lukso.network/tools/broadcast"},"LUKSO Mainnet Consensus Explorer Broadcast Tool")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://explorer.consensus.testnet.lukso.network/tools/broadcast"},"LUKSO Testnet Consensus Explorer Broadcast Tool")))),(0,r.kt)("li",{parentName:"ol"},"Upload the ",(0,r.kt)("inlineCode",{parentName:"li"},"bls_to_execution_change.json")," file"),(0,r.kt)("li",{parentName:"ol"},"Broadcast the withdrawal credential")))),(0,r.kt)(c,{value:"broadcast-from-node",label:"Broadcast Message from Node",mdxType:"TabItem"},(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Within the following section, ",(0,r.kt)("inlineCode",{parentName:"p"},"<PATH_TO_JSON_FILE>")," has to be exchanged with the path of the ",(0,r.kt)("inlineCode",{parentName:"p"},"bls_to_execution_change.json")," file.")),(0,r.kt)("div",null,(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Log into your node\u2019s terminal"),(0,r.kt)("li",{parentName:"ol"},"Copy the ",(0,r.kt)("inlineCode",{parentName:"li"},"bls_to_execution_change.json")," file to your node"),(0,r.kt)("li",{parentName:"ol"},"Send the JSON file to the local consensus instance using the following code:"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'curl -X POST -H "Content-type: application/json" -d @<PATH_TO_JSON_FILE> \\\nhttp://localhost:3500/eth/v1/beacon/pool/bls_to_execution_changes\n')))))}m.isMDXComponent=!0}}]);